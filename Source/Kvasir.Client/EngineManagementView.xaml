<UserControl
  x:Class="nGratis.AI.Kvasir.Client.EngineManagementView"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:client="clr-namespace:nGratis.AI.Kvasir.Client"
  xmlns:core="http://schemas.ngratis.com/2014/core"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  d:DataContext="{d:DesignInstance client:EngineManagementViewModel}"
  mc:Ignorable="d">
  <i:Interaction.Triggers>
    <i:EventTrigger EventName="Loaded">
      <i:InvokeCommandAction Command="{Binding PopulateCardSetsCommand, Mode=OneWay}" />
    </i:EventTrigger>
  </i:Interaction.Triggers>
  <StackPanel core:ChildrenMargin.Value="20,0" Orientation="Horizontal">
    <core:AweTileGroup Width="500" Header="RAW">
      <Grid core:ChildrenMargin.Value="10,10">
        <Grid.RowDefinitions>
          <RowDefinition Height="Auto" />
          <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="Auto" />
          <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        <core:AweField
          Grid.Row="0"
          Grid.Column="0"
          Width="120"
          HorizontalAlignment="Right"
          DisplayMemberPath="CardSet.Name"
          Header="Card Set"
          Kind="DropDown"
          Mode="Input"
          Values="{Binding CardSetViewModels, Mode=OneWay}"
          Value="{Binding SelectedCardSetViewModel, Mode=TwoWay}" />
        <StackPanel
          Grid.Row="0"
          Grid.Column="1"
          HorizontalAlignment="Right"
          core:ChildrenMargin.IsHorizontalExcluded="True"
          core:ChildrenMargin.Value="5,0"
          DataContext="{Binding SelectedCardSetViewModel, Mode=OneWay}"
          Orientation="Horizontal">
          <Button
            VerticalAlignment="Bottom"
            Command="{Binding ParseCardsCommand, Mode=OneWay}"
            Content="Parse ALL" />
          <Button
            VerticalAlignment="Bottom"
            Command="{Binding SelectedCardViewModel.ParseCardCommand, Mode=OneWay}"
            Content="Parse Current" />
        </StackPanel>
        <DataGrid
          Grid.Row="1"
          Grid.Column="0"
          core:AutoResetScroll.IsEnabled="True"
          AutoGenerateColumns="False"
          DataContext="{Binding SelectedCardSetViewModel, Mode=OneWay}"
          ItemsSource="{Binding CardViewModels, Mode=OneWay}"
          SelectedItem="{Binding SelectedCardViewModel, Mode=TwoWay}"
          Style="{StaticResource Cop.DataGrid.Virtualizing}">
          <DataGrid.Columns>
            <DataGridTextColumn
              Width="230"
              Binding="{Binding Card.Name, Mode=OneWay}"
              Header="Card" />
          </DataGrid.Columns>
        </DataGrid>
        <StackPanel
          Grid.Row="1"
          Grid.Column="1"
          core:ChildrenMargin.Value="0,10"
          DataContext="{Binding SelectedCardSetViewModel, Mode=OneWay}"
          Orientation="Vertical">
          <core:AweTile Header="Not Parsed Cards" Value="{Binding NotParsedCardCount, Mode=OneWay}" />
          <Grid core:ChildrenMargin.Value="10,0">
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="*" />
              <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <core:AweTile
              Grid.Column="0"
              Header="Valid Cards"
              Value="{Binding ValidCardCount, Mode=OneWay}" />
            <core:AweTile
              Grid.Column="1"
              Header="Invalid Cards"
              Value="{Binding InvalidCardCount, Mode=OneWay}" />
          </Grid>

          <Image
            Width="217"
            Height="303"
            HorizontalAlignment="Left"
            VerticalAlignment="Top"
            Source="{Binding SelectedCardViewModel.OriginalImage, Mode=OneWay}" />
        </StackPanel>
      </Grid>
    </core:AweTileGroup>
    <core:AweTileGroup Width="350" Header="PARSED">
      <StackPanel
        core:ChildrenMargin.Value="0,10"
        DataContext="{Binding SelectedCardSetViewModel.SelectedCardViewModel, Mode=OneWay}"
        Orientation="Vertical">
        <Grid core:ChildrenMargin.Value="10,0">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="3*" />
            <ColumnDefinition Width="*" />
          </Grid.ColumnDefinitions>
          <core:AweField
            Grid.Column="0"
            Header="Name"
            Kind="Text"
            Mode="Output"
            Value="{Binding CardInfo.Name, Mode=OneWay}" />
          <core:AweField
            Grid.Column="1"
            Header="Multiverse ID"
            Kind="Text"
            Mode="Output"
            Value="{Binding CardInfo.MultiverseId, Mode=OneWay}" />
        </Grid>
        <Grid core:ChildrenMargin.Value="10,0">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="3*" />
            <ColumnDefinition Width="*" />
          </Grid.ColumnDefinitions>
          <core:AweField Grid.Column="0" Header="Mana Cost">
            <core:AweField.CustomTemplate>
              <DataTemplate DataType="client:CardViewModel">
                <client:AweManaCostViewer ManaCost="{Binding CardInfo.ManaCost, Mode=OneWay}" />
              </DataTemplate>
            </core:AweField.CustomTemplate>
          </core:AweField>
          <core:AweField
            Grid.Column="1"
            Header="(Converted)"
            Kind="Text"
            Mode="Output"
            Value="{Binding CardInfo.ManaCost.ConvertedAmount, Mode=OneWay}" />
        </Grid>
        <Grid core:ChildrenMargin.Value="10,0">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
          </Grid.ColumnDefinitions>
          <core:AweField
            Grid.Column="1"
            Header="Power"
            Kind="Text"
            Mode="Output"
            Value="{Binding CardInfo.Power, Mode=OneWay}" />
          <core:AweField
            Grid.Column="2"
            Header="Toughness"
            Kind="Text"
            Mode="Output"
            Value="{Binding CardInfo.Toughness, Mode=OneWay}" />
        </Grid>
        <core:AweField
          Header="Messages"
          Kind="List"
          Mode="Output"
          Values="{Binding ParsingMessages, Mode=OneWay}" />
      </StackPanel>
    </core:AweTileGroup>
  </StackPanel>
</UserControl>